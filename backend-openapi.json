{"openapi":"3.1.0","info":{"title":"AdlexAgent","version":"0.1.0"},"paths":{"/api/chat/message":{"post":{"tags":["Chat"],"summary":"Chat Message","operationId":"chat_message_api_chat_message_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChatRequest"}}},"required":true},"responses":{"200":{"description":"Message processed successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChatResponse"}}}},"422":{"description":"Validation error"},"500":{"description":"Internal server error"},"503":{"description":"Service unavailable (database error)"}}}},"/api/chat/clear/{session_id}":{"post":{"tags":["Chat"],"summary":"Clear Session","operationId":"clear_session_api_chat_clear__session_id__post","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"string","title":"Session Id"}}],"responses":{"200":{"description":"Session cleared successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SessionClearResponse"}}}},"404":{"description":"Session not found"},"503":{"description":"Service unavailable (database error)"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/chat/session/{session_id}/state":{"get":{"tags":["Chat"],"summary":"Get Session State","operationId":"get_session_state_api_chat_session__session_id__state_get","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"string","title":"Session Id"}}],"responses":{"200":{"description":"Session state returned successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SessionStateResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/chat/bootstrap":{"get":{"tags":["Chat"],"summary":"Get Bootstrap Messages","operationId":"get_bootstrap_messages_api_chat_bootstrap_get","parameters":[{"name":"session_id","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Session Id"}}],"responses":{"200":{"description":"Bootstrap messages returned successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/BootstrapResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/chat/company/name/validation":{"post":{"tags":["Chat"],"summary":"Company Name Validation","operationId":"company_name_validation_api_chat_company_name_validation_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CompanyNameValidationRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/documents/passport/upload":{"post":{"tags":["Documents"],"summary":"Upload Passport Scan","description":"Upload a passport scan for a session.\n\nArgs:\n    session_id: Session identifier\n    file: Uploaded passport scan file\n    storage_service: Injected storage service\n\nReturns:\n    Upload response with document details\n\nRaises:\n    HTTPException: If file is invalid or upload fails","operationId":"upload_passport_scan_api_documents_passport_upload_post","parameters":[{"name":"session_id","in":"query","required":true,"schema":{"type":"string","title":"Session Id"}}],"requestBody":{"required":true,"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_upload_passport_scan_api_documents_passport_upload_post"}}}},"responses":{"201":{"description":"Passport scan uploaded successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PassportUploadResponse"}}}},"400":{"description":"Invalid file or file too large"},"422":{"description":"Validation error"},"500":{"description":"Internal server error"}}}},"/api/documents/passport/list/{session_id}":{"get":{"tags":["Documents"],"summary":"List Passport Scans","description":"List all passport scans for a session.\n\nArgs:\n    session_id: Session identifier\n    storage_service: Injected storage service\n\nReturns:\n    List of uploaded passport scans\n\nRaises:\n    HTTPException: If listing fails","operationId":"list_passport_scans_api_documents_passport_list__session_id__get","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"string","title":"Session Id"}}],"responses":{"200":{"description":"List of passport scans returned successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PassportListResponse"}}}},"500":{"description":"Internal server error"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/documents/passport/{session_id}/{document_id}":{"delete":{"tags":["Documents"],"summary":"Delete Passport Scan","description":"Delete a passport scan.\n\nArgs:\n    session_id: Session identifier\n    document_id: Document identifier\n    storage_service: Injected storage service\n\nRaises:\n    HTTPException: If document not found or deletion fails","operationId":"delete_passport_scan_api_documents_passport__session_id___document_id__delete","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"string","title":"Session Id"}},{"name":"document_id","in":"path","required":true,"schema":{"type":"string","title":"Document Id"}}],"responses":{"204":{"description":"Passport scan deleted successfully"},"404":{"description":"Document not found"},"500":{"description":"Internal server error"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/health":{"get":{"tags":["Health"],"summary":"Health check endpoint","description":"Check the health status of the application and its dependencies","operationId":"health_check_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HealthCheck"}}}}}}},"/health/ready":{"get":{"tags":["Health"],"summary":"Readiness probe","description":"Check if the application is ready to accept traffic","operationId":"readiness_check_health_ready_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"additionalProperties":{"type":"string"},"type":"object","title":"Response Readiness Check Health Ready Get"}}}}}}},"/health/live":{"get":{"tags":["Health"],"summary":"Liveness probe","description":"Check if the application is alive","operationId":"liveness_check_health_live_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"additionalProperties":{"type":"string"},"type":"object","title":"Response Liveness Check Health Live Get"}}}}}}},"/metrics/":{"get":{"tags":["Metrics"],"summary":"Get Prometheus Metrics","operationId":"get_prometheus_metrics_metrics__get","responses":{"200":{"description":"Successful Response"}}}},"/metrics/json":{"get":{"tags":["Metrics"],"summary":"Get Metrics Json","operationId":"get_metrics_json_metrics_json_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MetricsResponse"}}}}}}},"/admin/set-payment-link":{"post":{"tags":["admin"],"summary":"Set Payment Link","description":"Set payment link for a specific user session.","operationId":"set_payment_link_admin_set_payment_link_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SetPaymentLinkRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/admin/set-kyc-link":{"post":{"tags":["admin"],"summary":"Set Kyc Link","description":"Set KYC verification link for a specific user session.","operationId":"set_kyc_link_admin_set_kyc_link_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SetKYCLinkRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/admin/set-signature-link":{"post":{"tags":["admin"],"summary":"Set Signature Link","description":"Set document signature link for a specific user session.","operationId":"set_signature_link_admin_set_signature_link_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SetSignatureLinkRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/admin/set-documents":{"post":{"tags":["admin"],"summary":"Set Documents","description":"Set final registration documents for a specific user session.","operationId":"set_documents_admin_set_documents_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SetDocumentsRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/admin/update-status":{"post":{"tags":["admin"],"summary":"Update External Status","description":"Update status of external process (payment, KYC, signature).","operationId":"update_external_status_admin_update_status_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateExternalStatusRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/admin/webhook":{"post":{"tags":["admin"],"summary":"Webhook Handler","description":"Handle webhook notifications from external services.","operationId":"webhook_handler_admin_webhook_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/WebhookNotification"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/admin/session-status/{external_key}":{"get":{"tags":["admin"],"summary":"Get Session Status","description":"Get current status of a user session.","operationId":"get_session_status_admin_session_status__external_key__get","parameters":[{"name":"external_key","in":"path","required":true,"schema":{"type":"string","title":"External Key"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}}},"components":{"schemas":{"AgentResponse":{"properties":{"text":{"type":"string","title":"Text","description":"Main message text to send to user"},"keyboard":{"anyOf":[{"$ref":"#/components/schemas/Keyboard"},{"type":"null"}],"description":"Keyboard with buttons if user interaction is needed"}},"type":"object","required":["text"],"title":"AgentResponse","description":"Structured response from the agent.\n\nUse this model to structure your responses:\n- Always provide 'text' with your message\n- Add 'keyboard' with buttons when you need user interaction\n- For welcome messages after name collection, include a \"Start\" button\n- For questions requiring user choice, provide relevant buttons"},"Body_upload_passport_scan_api_documents_passport_upload_post":{"properties":{"file":{"type":"string","format":"binary","title":"File","description":"Passport scan file (PDF, JPG, JPEG, PNG)"}},"type":"object","required":["file"],"title":"Body_upload_passport_scan_api_documents_passport_upload_post"},"BootstrapResponse":{"properties":{"session_id":{"type":"string","title":"Session Id"},"message":{"$ref":"#/components/schemas/AgentResponse"}},"type":"object","required":["session_id","message"],"title":"BootstrapResponse"},"Button":{"properties":{"text":{"type":"string","title":"Text","description":"Text to display on the button"},"action":{"$ref":"#/components/schemas/ButtonAction","description":"Action to perform when button is clicked","default":"message"},"link":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Link","description":"URL for LINK, EXTERNAL_PAYMENT, EXTERNAL_KYC, or EXTERNAL_SIGNATURE actions"},"callback_data":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Callback Data","description":"Optional data for custom action handling"}},"type":"object","required":["text"],"title":"Button","description":"Button configuration with action and optional link."},"ButtonAction":{"type":"string","enum":["message","link","upload","external_payment","external_kyc","external_signature"],"title":"ButtonAction","description":"Action types for buttons."},"ChatRequest":{"properties":{"message":{"type":"string","title":"Message"},"session_id":{"type":"string","title":"Session Id","default":"default"}},"type":"object","required":["message"],"title":"ChatRequest"},"ChatResponse":{"properties":{"response":{"$ref":"#/components/schemas/AgentResponse"},"session_id":{"type":"string","title":"Session Id"}},"type":"object","required":["response","session_id"],"title":"ChatResponse"},"CompanyNameValidationRequest":{"properties":{"name":{"type":"string","minLength":1,"title":"Name","description":"Company name to validate"},"company_type":{"type":"string","title":"Company Type","description":"Type of company (Freezone Company or Mainland Company)"}},"type":"object","required":["name","company_type"],"title":"CompanyNameValidationRequest","description":"Request model for single company name validation."},"ConversationStatus":{"type":"string","enum":["INITIAL_GREETING","NAME_COLLECTED","PROCESS_STARTED","REGISTRATION_FLOW","COMPANY_TYPE_SELECTION","COMPANY_NAME_COLLECTION","COMPANY_NAME_CHECKING","COMPANY_NAME_SUGGESTIONS","COMPANY_NAME_SELECTED","SHAREHOLDERS_COUNT","SHAREHOLDERS_NAME_COLLECTION","SHARE_ALLOCATION","SHAREHOLDERS_BIRTH_DATES","SHAREHOLDERS_NATIONALITIES","VISA_PACKAGE_SELECTION","BUSINESS_ACTIVITIES_SELECTION","DOCUMENT_UPLOAD","PAYMENT_PENDING","KYC_PENDING","SIGNATURE_PENDING","REGISTRATION_COMPLETE","UNKNOWN"],"title":"ConversationStatus"},"DocumentInfo":{"properties":{"document_id":{"type":"string","title":"Document Id","description":"Unique document identifier"},"filename":{"type":"string","title":"Filename","description":"Original filename"},"url":{"type":"string","title":"Url","description":"URL to access the document"},"upload_date":{"type":"string","title":"Upload Date","description":"Upload date in ISO format"},"file_size":{"type":"integer","title":"File Size","description":"File size in bytes"}},"type":"object","required":["document_id","filename","url","upload_date","file_size"],"title":"DocumentInfo","description":"Information about an uploaded document."},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"HealthCheck":{"properties":{"status":{"type":"string","title":"Status","description":"Overall health status (healthy/degraded/unhealthy)"},"timestamp":{"type":"string","format":"date-time","title":"Timestamp","description":"Timestamp of health check"},"version":{"type":"string","title":"Version","description":"Application version"},"checks":{"additionalProperties":{"additionalProperties":{"type":"string"},"type":"object"},"type":"object","title":"Checks","description":"Individual component health checks"}},"type":"object","required":["status","timestamp","version","checks"],"title":"HealthCheck"},"Keyboard":{"properties":{"buttons":{"items":{"$ref":"#/components/schemas/Button"},"type":"array","title":"Buttons","description":"List of buttons to display"}},"type":"object","required":["buttons"],"title":"Keyboard","description":"Keyboard configuration."},"MetricsResponse":{"properties":{"requests":{"additionalProperties":true,"type":"object","title":"Requests","description":"Request statistics"},"errors":{"additionalProperties":true,"type":"object","title":"Errors","description":"Error statistics"},"latency":{"additionalProperties":true,"type":"object","title":"Latency","description":"Latency statistics by endpoint"}},"type":"object","required":["requests","errors"],"title":"MetricsResponse"},"PassportListResponse":{"properties":{"documents":{"items":{"$ref":"#/components/schemas/DocumentInfo"},"type":"array","title":"Documents","description":"List of uploaded documents"},"total":{"type":"integer","title":"Total","description":"Total number of documents"}},"type":"object","required":["documents","total"],"title":"PassportListResponse","description":"Response containing list of uploaded passport scans."},"PassportUploadResponse":{"properties":{"success":{"type":"boolean","title":"Success","description":"Whether upload was successful"},"document_id":{"type":"string","title":"Document Id","description":"Unique document identifier"},"url":{"type":"string","title":"Url","description":"URL to access the document"},"filename":{"type":"string","title":"Filename","description":"Original filename"},"upload_date":{"type":"string","title":"Upload Date","description":"Upload date in ISO format"},"file_size":{"type":"integer","title":"File Size","description":"File size in bytes"}},"type":"object","required":["success","document_id","url","filename","upload_date","file_size"],"title":"PassportUploadResponse","description":"Response from passport scan upload."},"SessionClearResponse":{"properties":{"message":{"type":"string","title":"Message"}},"type":"object","required":["message"],"title":"SessionClearResponse"},"SessionStateResponse":{"properties":{"session_id":{"type":"string","title":"Session Id"},"status":{"$ref":"#/components/schemas/ConversationStatus"},"system_prompt":{"type":"string","title":"System Prompt"},"state":{"additionalProperties":true,"type":"object","title":"State"},"updated_at":{"type":"string","format":"date-time","title":"Updated At"}},"type":"object","required":["session_id","status","system_prompt","updated_at"],"title":"SessionStateResponse"},"SetDocumentsRequest":{"properties":{"external_key":{"type":"string","title":"External Key"},"trade_license_url":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Trade License Url"},"certificate_url":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Certificate Url"},"moa_url":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Moa Url"},"aoa_url":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Aoa Url"}},"type":"object","required":["external_key"],"title":"SetDocumentsRequest","description":"Request to set final documents for a user."},"SetKYCLinkRequest":{"properties":{"external_key":{"type":"string","title":"External Key"},"kyc_link":{"type":"string","title":"Kyc Link"},"kyc_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Kyc Id"}},"type":"object","required":["external_key","kyc_link"],"title":"SetKYCLinkRequest","description":"Request to set KYC link for a user."},"SetPaymentLinkRequest":{"properties":{"external_key":{"type":"string","title":"External Key"},"payment_link":{"type":"string","title":"Payment Link"},"amount":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Amount"},"reference":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Reference"}},"type":"object","required":["external_key","payment_link"],"title":"SetPaymentLinkRequest","description":"Request to set payment link for a user."},"SetSignatureLinkRequest":{"properties":{"external_key":{"type":"string","title":"External Key"},"signature_link":{"type":"string","title":"Signature Link"},"signature_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Signature Id"}},"type":"object","required":["external_key","signature_link"],"title":"SetSignatureLinkRequest","description":"Request to set signature link for a user."},"UpdateExternalStatusRequest":{"properties":{"external_key":{"type":"string","title":"External Key"},"process_type":{"type":"string","title":"Process Type"},"status":{"type":"string","title":"Status"}},"type":"object","required":["external_key","process_type","status"],"title":"UpdateExternalStatusRequest","description":"Request to update external process status."},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"},"WebhookNotification":{"properties":{"user_id":{"type":"string","title":"User Id"},"process_type":{"type":"string","title":"Process Type"},"status":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Status"},"payment_link":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Payment Link"},"kyc_link":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Kyc Link"},"signature_link":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Signature Link"},"documents":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Documents"}},"type":"object","required":["user_id","process_type"],"title":"WebhookNotification","description":"Webhook notification from external service."}}}}